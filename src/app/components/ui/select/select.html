<div class="relative" (clickOutside)="closeDropdown()">
  <button
    #triggerButton
    type="button"
    class="w-full flex items-center justify-between gap-2 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl px-3 py-2.5 text-sm transition-all hover:border-emerald-500 dark:hover:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:border-gray-200 dark:disabled:hover:border-gray-600"
    [disabled]="disabled"
    (click)="toggleDropdown()"
  >
    <span class="text-gray-900 dark:text-gray-100 font-medium">
      {{ selectedOption?.label || placeholder }}
    </span>
    <ng-icon
      name="heroChevronDownSolid"
      class="size-4 text-gray-500 dark:text-gray-400 transition-transform"
      [class.rotate-180]="isOpen()"
    ></ng-icon>
  </button>
</div>

@if (isOpen()) {
  <div
    class="fixed z-[9999] bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl shadow-lg overflow-hidden animate-in"
    [style.top.px]="dropdownPosition().top"
    [style.left.px]="dropdownPosition().left"
    [style.width.px]="dropdownPosition().width"
  >
    @for (option of options; track option.value) {
    <button
      type="button"
      class="w-full flex items-center gap-2 px-3 py-2.5 text-sm text-left transition-colors hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent"
      [class.bg-emerald-50]="option.value === value && !option.disabled"
      [class.dark:bg-emerald-900/20]="option.value === value && !option.disabled"
      [class.text-emerald-600]="option.value === value && !option.disabled"
      [class.dark:text-emerald-400]="option.value === value && !option.disabled"
      [class.font-medium]="option.value === value"
      [disabled]="option.disabled"
      (click)="selectOption(option)"
    >
      {{ option.label }}
      @if (option.value === value) {
      <span class="ml-auto">
        <svg
          class="size-4 text-emerald-600 dark:text-emerald-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
      </span>
      }
    </button>
    }
  </div>
}

